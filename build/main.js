var L=Object.defineProperty,Je=Object.defineProperties,Qe=Object.getOwnPropertyDescriptor,Ye=Object.getOwnPropertyDescriptors,et=Object.getOwnPropertyNames,V=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var q=(t,e,o)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,w=(t,e)=>{for(var o in e||(e={}))Z.call(e,o)&&q(t,o,e[o]);if(V)for(var o of V(e))tt.call(e,o)&&q(t,o,e[o]);return t},R=(t,e)=>Je(t,Ye(e));var f=(t,e)=>()=>(t&&(e=t(t=0)),e);var nt=(t,e)=>{for(var o in e)L(t,o,{get:e[o],enumerable:!0})},ot=(t,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of et(e))!Z.call(t,n)&&n!==o&&L(t,n,{get:()=>e[n],enumerable:!(r=Qe(e,n))||r.enumerable});return t};var K=t=>ot(L({},"__esModule",{value:!0}),t);function H(t,e){let o=`${J}`;return J+=1,T[o]={handler:e,name:t},function(){delete T[o]}}function $(t,e){let o=!1;return H(t,function(...r){o!==!0&&(o=!0,e(...r))})}function Q(t,e){let o=!1;for(let r in T)T[r].name===t&&(T[r].handler.apply(null,e),o=!0);if(o===!1)throw new Error(`No event handler with name \`${t}\``)}var T,J,d,Y=f(()=>{T={},J=0;d=typeof window=="undefined"?function(t,...e){figma.ui.postMessage([t,...e])}:function(t,...e){window.parent.postMessage({pluginMessage:[t,...e]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(t){if(!Array.isArray(t))return;let[e,...o]=t;typeof e=="string"&&Q(e,o)}:window.onmessage=function(t){if(typeof t.data.pluginMessage=="undefined")return;let e=t.data.pluginMessage;if(!Array.isArray(e))return;let[o,...r]=t.data.pluginMessage;typeof o=="string"&&Q(o,r)}});function P(t,e){if(typeof __html__=="undefined")throw new Error("No UI defined");let o=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof e=="undefined"?{}:e)};${__html__}</script>`;figma.showUI(o,R(w({},t),{themeColors:typeof t.themeColors=="undefined"?!0:t.themeColors}))}var ee=f(()=>{});var S=f(()=>{Y();ee()});function rt(t,e){return t.family===e.family&&t.style===e.style}function te(t){return`${t.family}||${t.style}`}function ne(t){let e={Thin:"100","Extra Light":"200",Light:"300",Regular:"400",Medium:"500","Semi Bold":"600",Bold:"700","Extra Bold":"800",Black:"900"},o=t.match(/\d{3}/);if(o)return o[0];for(let[r,n]of Object.entries(e))if(t.includes(r))return n;return t}function oe(t,e,o){let r;e!==void 0&&o!==void 0?r=t.getRangeLineHeight(e,o):r=t.lineHeight,r===figma.mixed&&(r=t.getRangeLineHeight(0,1));let n=r;if(n.unit==="PIXELS"&&"value"in n)return n.value;if(n.unit==="PERCENT"&&"value"in n){let i=e!==void 0&&o!==void 0?t.getRangeFontSize(e,o):t.fontSize;return(i===figma.mixed?16:i)*n.value/100}else{let i=e!==void 0&&o!==void 0?t.getRangeFontSize(e,o):t.fontSize;return(i===figma.mixed?16:i)*1.2}}function A(t){let e=[];function o(n){let i=n.characters.length;if(i!==0)try{let a=n.fontName;if(a!==figma.mixed){let s=a,c=n.fontSize;e.push({nodeId:n.id,nodeName:n.name,rangeStart:0,rangeEnd:i,font:{family:s.family,style:s.style},fontSize:c,lineHeightPx:oe(n),fontWeight:ne(s.style)})}else{let s=0;for(;s<i;){let c=n.getRangeFontName(s,s+1),l=n.getRangeFontSize(s,s+1),u=s+1;for(;u<i;){let m=n.getRangeFontName(u,u+1),g=n.getRangeFontSize(u,u+1);if(!rt(c,m)||l!==g)break;u++}e.push({nodeId:n.id,nodeName:n.name,rangeStart:s,rangeEnd:u,font:{family:c.family,style:c.style},fontSize:l,lineHeightPx:oe(n,s,u),fontWeight:ne(c.style)}),s=u}}}catch(a){console.warn(`Failed to process text node ${n.id}:`,a)}}function r(n){if(n.type==="TEXT")o(n);else if("children"in n)for(let i of n.children)r(i)}for(let n of t)r(n);return e}function E(t){let e=new Map;for(let o of t){let r=te(o.font),n=e.get(r);if(!n){let i=new Set,a=[];for(let s of t)te(s.font)===r&&(a.push(s),i.add(s.nodeId));n={font:o.font,count:a.length,nodesCount:i.size,occurrences:a},e.set(r,n)}}return Array.from(e.values()).sort((o,r)=>r.count-o.count)}function it(t){let e=new Map;for(let o of t){let r=Math.round(o.lineHeightPx).toString(),n=e.get(r)||[];n.push(o),e.set(r,n)}return Array.from(e.entries()).map(([o,r])=>({key:`lineHeight:${o}`,label:`Line Height: ${o}px`,occurrences:r,count:r.length}))}function at(t){let e=new Map;for(let o of t){let r=Math.round(o.fontSize).toString(),n=e.get(r)||[];n.push(o),e.set(r,n)}return Array.from(e.entries()).map(([o,r])=>({key:`fontSize:${o}`,label:`Font Size: ${o}px`,occurrences:r,count:r.length}))}function st(t){let e=new Map;for(let o of t){let r=o.fontWeight,n=e.get(r)||[];n.push(o),e.set(r,n)}return Array.from(e.entries()).map(([o,r])=>({key:`fontWeight:${o}`,label:`Weight: ${o}`,occurrences:r,count:r.length}))}function ct(t){let e=new Map;for(let o of t){let r=o.font.family,n=e.get(r)||[];n.push(o),e.set(r,n)}return Array.from(e.entries()).map(([o,r])=>({key:`fontFamily:${o}`,label:`Family: ${o}`,occurrences:r,count:r.length}))}function v(t){return{lineHeight:it(t),fontSize:at(t),fontWeight:st(t),fontFamily:ct(t)}}var C=f(()=>{"use strict"});var re,ie=f(()=>{"use strict";S();C();re=async function(){let t=figma.currentPage.selection;if(t.length===0){figma.notify("Please select at least one layer",{error:!0}),d("FONTS_SCANNED",{fonts:[],groups:{lineHeight:[],fontSize:[],fontWeight:[],fontFamily:[]},totalNodes:0});return}let e=A(t);if(e.length===0){figma.notify("No text layers found in selection"),d("FONTS_SCANNED",{fonts:[],groups:{lineHeight:[],fontSize:[],fontWeight:[],fontFamily:[]},totalNodes:0});return}let o=E(e),r=v(e),n=new Set(e.map(i=>i.nodeId));d("FONTS_SCANNED",{fonts:o,groups:r,totalNodes:n.size}),figma.notify(`Found ${o.length} fonts in ${n.size} text layers`)}});var ae,se=f(()=>{"use strict";S();ae=async function(t){let e={success:!1,affectedNodes:0,affectedRanges:0,errors:[]};try{await figma.loadFontAsync({family:t.newFont.family,style:t.newFont.style});let o=new Set;for(let r of t.occurrences)try{let n=figma.getNodeById(r.nodeId);if(!n||n.type!=="TEXT")continue;try{await figma.loadFontAsync({family:r.font.family,style:r.font.style})}catch(i){}if(n.setRangeFontName(r.rangeStart,r.rangeEnd,{family:t.newFont.family,style:t.newFont.style}),t.newLineHeight)try{n.setRangeLineHeight(r.rangeStart,r.rangeEnd,{value:t.newLineHeight,unit:"PIXELS"})}catch(i){n.lineHeight={value:t.newLineHeight,unit:"PIXELS"}}if(t.newFontSize)try{n.setRangeFontSize(r.rangeStart,r.rangeEnd,t.newFontSize)}catch(i){n.fontSize=t.newFontSize}e.affectedRanges++,o.add(n.id)}catch(n){e.errors.push(`Error updating node ${r.nodeId}: ${n}`)}e.affectedNodes=o.size,e.success=e.affectedRanges>0,e.success?figma.notify(`Updated ${e.affectedRanges} text ranges in ${e.affectedNodes} layers`):figma.notify("Failed to apply changes",{error:!0})}catch(o){e.errors.push(`Font loading failed: ${o}`),figma.notify("Failed to load font",{error:!0})}d("REPLACEMENT_COMPLETE",e)}});var ce,le=f(()=>{"use strict";S();C();ce=async function(t){let e=0,o=0,r=new Set,n=[];try{let i=async(a,s)=>{let l=(await figma.listAvailableFontsAsync()).filter(p=>p.fontName.family===a);if(l.length===0)return null;let m={100:["Thin","Hairline","100","100 Thin"],200:["Extra Light","ExtraLight","Ultra Light","UltraLight","200","200 Extra Light"],300:["Light","Lt","300","300 Light"],400:["Regular","Normal","Book","Rg","400","400 Regular"],500:["Medium","Md","500","500 Medium"],600:["Semi Bold","SemiBold","Demi Bold","DemiBold","600","600 Semi Bold"],700:["Bold","Bd","700","700 Bold"],800:["Extra Bold","ExtraBold","Ultra Bold","UltraBold","800","800 Extra Bold"],900:["Black","Heavy","Bk","900","900 Black"]}[s]||[];for(let p of m){let h=l.find(y=>y.fontName.style.toLowerCase()===p.toLowerCase());if(h)return h.fontName.style}for(let p of m){let h=l.find(y=>y.fontName.style.toLowerCase().includes(p.toLowerCase()));if(h)return h.fontName.style}let g=l.find(p=>p.fontName.style.toLowerCase()==="regular"||p.fontName.style.toLowerCase()==="normal"||p.fontName.style.toLowerCase()==="400");return g?g.fontName.style:l[0].fontName.style};for(let a of t.occurrences)try{let s=figma.getNodeById(a.nodeId);if(!s||s.type!=="TEXT")continue;try{await figma.loadFontAsync({family:a.font.family,style:a.font.style})}catch(c){n.push(`Failed to load font ${a.font.family} ${a.font.style}`);continue}if(t.groupType==="fontWeight"){let c=t.targetValue,l=await i(a.font.family,c);if(!l){n.push(`Could not find matching weight ${c} for ${a.font.family}`);continue}await figma.loadFontAsync({family:a.font.family,style:l}),s.setRangeFontName(a.rangeStart,a.rangeEnd,{family:a.font.family,style:l}),e++}else if(t.groupType==="lineHeight"){let c=t.targetValue;try{s.setRangeLineHeight(a.rangeStart,a.rangeEnd,{value:c,unit:"PIXELS"})}catch(l){s.lineHeight={value:c,unit:"PIXELS"}}e++}else if(t.groupType==="fontSize"){let c=t.targetValue;try{s.setRangeFontSize(a.rangeStart,a.rangeEnd,c)}catch(l){s.fontSize=c}e++}r.add(s.id)}catch(s){n.push(`Error updating node ${a.nodeId}: ${s}`)}o=r.size,e>0?(figma.notify(`Updated ${e} range${e===1?"":"s"} in ${o} layer${o===1?"":"s"}`),d("FONTS_SCANNED",{fonts:E(A(figma.currentPage.selection)),groups:v(A(figma.currentPage.selection)),totalNodes:r.size})):(figma.notify("No changes applied",{error:!0}),n.length>0&&console.error("Bulk update errors:",n))}catch(i){figma.notify(`Bulk update failed: ${i}`,{error:!0}),console.error("Bulk update error:",i)}}});var fe,me=f(()=>{"use strict";S();fe=async function(){let t=await figma.listAvailableFontsAsync();d("AVAILABLE_FONTS",t)}});var ue,de=f(()=>{"use strict";ue=function(t){let e=new Set(t.map(r=>r.nodeId)),o=[];for(let r of Array.from(e)){let n=figma.getNodeById(r);n&&o.push(n)}o.length>0&&(figma.currentPage.selection=o,figma.viewport.scrollAndZoomIntoView(o))}});var ge,pe=f(()=>{"use strict";ge=function(t){let e=figma.getNodeById(t.nodeId);e&&(figma.currentPage.selection=[e],figma.viewport.scrollAndZoomIntoView([e]))}});var he,ye=f(()=>{he={familyName:"Arial",category:"sans-serif",capHeight:1467,ascent:1854,descent:-434,lineGap:67,unitsPerEm:2048,xHeight:1062,xWidthAvg:913,subsets:{latin:{xWidthAvg:913},thai:{xWidthAvg:1536}}}});var z,xe=f(()=>{z={familyName:"Helvetica",category:"sans-serif",capHeight:1469,ascent:1577,descent:-471,lineGap:0,unitsPerEm:2048,xHeight:1071,xWidthAvg:913,subsets:{latin:{xWidthAvg:913},thai:{xWidthAvg:1298}}}});var He,Se=f(()=>{He={familyName:"Roboto",category:"sans-serif",capHeight:1456,ascent:1900,descent:-500,lineGap:0,unitsPerEm:2048,xHeight:1082,xWidthAvg:911,subsets:{latin:{xWidthAvg:911},thai:{xWidthAvg:908}}}});var Fe,Ne=f(()=>{Fe={familyName:"Inter",category:"sans-serif",capHeight:2048,ascent:2728,descent:-680,lineGap:0,unitsPerEm:2816,xHeight:1536,xWidthAvg:1344,subsets:{latin:{xWidthAvg:1344},thai:{xWidthAvg:2800}}}});var Te,Ae=f(()=>{Te={familyName:"Open Sans",category:"sans-serif",capHeight:1462,ascent:2189,descent:-600,lineGap:0,unitsPerEm:2048,xHeight:1096,xWidthAvg:960,subsets:{latin:{xWidthAvg:960},thai:{xWidthAvg:1229}}}});var Le,Ee=f(()=>{Le={familyName:"Montserrat",category:"sans-serif",capHeight:700,ascent:968,descent:-251,lineGap:0,unitsPerEm:1e3,xHeight:517,xWidthAvg:503,subsets:{latin:{xWidthAvg:503},thai:{xWidthAvg:587}}}});var ve,be=f(()=>{ve={familyName:"Lato",category:"sans-serif",capHeight:1433,ascent:1974,descent:-426,lineGap:0,unitsPerEm:2e3,xHeight:1013,xWidthAvg:871,subsets:{latin:{xWidthAvg:871},thai:{xWidthAvg:1063}}}});var Ie,Oe=f(()=>{Ie={familyName:"Poppins",category:"sans-serif",capHeight:698,ascent:1050,descent:-350,lineGap:100,unitsPerEm:1e3,xHeight:548,xWidthAvg:500,subsets:{latin:{xWidthAvg:500},thai:{xWidthAvg:500}}}});var Me,we=f(()=>{Me={familyName:"Raleway",category:"sans-serif",capHeight:710,ascent:940,descent:-234,lineGap:0,unitsPerEm:1e3,xHeight:519,xWidthAvg:463,subsets:{latin:{xWidthAvg:463},thai:{xWidthAvg:608}}}});var Re,$e=f(()=>{Re={familyName:"Source Sans 3",category:"sans-serif",capHeight:660,ascent:1024,descent:-400,lineGap:0,unitsPerEm:1e3,xHeight:486,xWidthAvg:418,subsets:{latin:{xWidthAvg:418},thai:{xWidthAvg:653}}}});function b(t){if(_[t])return _[t];let e=t.toLowerCase();for(let[o,r]of Object.entries(_))if(o.toLowerCase()===e)return r;return null}var _,B=f(()=>{"use strict";ye();xe();Se();Ne();Ae();Ee();be();Oe();we();$e();_={Arial:he,Helvetica:z,"Helvetica Neue":z,Roboto:He,Inter:Fe,"Open Sans":Te,Montserrat:Le,Lato:ve,Poppins:Ie,Raleway:Me,"Source Sans 3":Re}});function lt(t){if("leading"in t&&"lineGap"in t)throw new Error("Only a single line height style can be provided. Please pass either `lineGap` OR `leading`.");if("capHeight"in t&&"fontSize"in t)throw new Error("Please pass either `capHeight` OR `fontSize`, not both.");let{fontMetrics:e}=t,o=e.capHeight/e.unitsPerEm,r,n;if("capHeight"in t)r=t.capHeight/o,n=t.capHeight;else if("fontSize"in t)r=t.fontSize,n=t.fontSize*o;else throw new Error("Please pass either `capHeight` OR `fontSize`.");let i;return"lineGap"in t?i=n+t.lineGap:"leading"in t&&(i=t.leading),{fontSize:r,lineHeight:i,fontMetrics:e}}function Pe(t){let{fontSize:e,lineHeight:o,fontMetrics:r}=lt(t),n=Math.abs(r.descent),i=r.capHeight/r.unitsPerEm,a=n/r.unitsPerEm,s=r.ascent/r.unitsPerEm,c=r.lineGap/r.unitsPerEm,m=(r.ascent+r.lineGap+n)/r.unitsPerEm*e,g=y=>{if(o){let F=(m-o)/2;return y-F/e}return y},p=g(s-i+c/2)*-1,h=g(a+c/2)*-1;return{fontSize:`${I(e)}px`,lineHeight:o?`${I(o)}px`:"normal",capHeightTrim:`${I(p)}em`,baselineTrim:`${I(h)}em`}}var I,Ce=f(()=>{I=t=>parseFloat(t.toFixed(4))});function ze(t,e,o){try{let r=Pe({fontSize:t,leading:e,fontMetrics:o}),n=Math.round(parseFloat(r.capHeightTrim)*t),i=Math.round(parseFloat(r.baselineTrim)*t);return{topTrim:Math.abs(n),bottomTrim:Math.abs(i)}}catch(r){return console.error("Error calculating trim values:",r),{topTrim:0,bottomTrim:0}}}var _e=f(()=>{"use strict";Ce()});function Be(t){if(t.characters.length===0)return!1;let e=t.getRangeFontName(0,1);if(e===figma.mixed)return!0;for(let o=1;o<t.characters.length;o++){let r=t.getRangeFontName(o,o+1);if(r===figma.mixed||typeof e!="symbol"&&typeof r!="symbol"&&(e.family!==r.family||e.style!==r.style))return!0}return!1}function We(t){if(t.characters.length===0)return!1;let e=t.getRangeFontSize(0,1);if(e===figma.mixed)return!0;for(let o=1;o<t.characters.length;o++){let r=t.getRangeFontSize(o,o+1);if(r===figma.mixed||r!==e)return!0}return!1}function Ge(t){if(t.characters.length===0)return!1;let e=t.getRangeLineHeight(0,1);if(e===figma.mixed)return!0;for(let o=1;o<t.characters.length;o++){let r=t.getRangeLineHeight(o,o+1);if(r===figma.mixed||typeof e!="symbol"&&typeof r!="symbol"&&(e.unit!==r.unit||e.unit!=="AUTO"&&r.unit!=="AUTO"&&"value"in e&&"value"in r&&e.value!==r.value))return!0}return!1}var Ue=f(()=>{"use strict"});function O(t){let e=t.lineHeight,o=typeof t.fontSize=="number"?t.fontSize:16;if(e===figma.mixed){let r=t.getRangeLineHeight(0,1);if(r!==figma.mixed)return r.unit==="PIXELS"?r.value:r.unit==="PERCENT"?r.value/100*o:o*1.2}else return e.unit==="PIXELS"?e.value:e.unit==="PERCENT"?e.value/100*o:o*1.2;return 16*1.2}var W=f(()=>{"use strict"});var ke,je=f(()=>{"use strict";S();B();_e();Ue();W();ke=async function(){let t=figma.currentPage.selection,e={success:!1,trimmedNodes:0,trimmedTexts:[],errors:[]};if(t.length===0){e.errors.push("Please select at least one text layer"),figma.notify("Please select at least one text layer",{error:!0}),d("TRIM_COMPLETE",e);return}function o(n){let i=[];for(let a of n)a.type==="TEXT"?i.push(a):"children"in a&&i.push(...o(a.children));return i}let r=o(t);if(r.length===0){e.errors.push("No text layers found in selection"),figma.notify("No text layers found in selection",{error:!0}),d("TRIM_COMPLETE",e);return}for(let n of r)try{if(Be(n)){e.errors.push(`${n.name}: Text has mixed fonts, cannot trim`);continue}if(We(n)){e.errors.push(`${n.name}: Text has mixed font sizes, cannot trim`);continue}if(Ge(n)){e.errors.push(`${n.name}: Text has mixed line heights, cannot trim`);continue}let i=n.fontName;if(i===figma.mixed){e.errors.push(`${n.name}: Cannot determine font`);continue}let a=n.fontSize;if(a===figma.mixed){e.errors.push(`${n.name}: Cannot determine font size`);continue}let s=O(n);console.log(`[Trim Debug] ${n.name}:`,{fontSize:a,lineHeightPx:s,fontFamily:i.family,lineHeightRaw:n.lineHeight});let c=b(i.family);if(!c){e.errors.push(`${n.name}: Font "${i.family}" is not currently supported. Try Arial, Roboto, Inter, or other common fonts.`);continue}let{topTrim:l,bottomTrim:u}=ze(a,s,c);if(console.log("[Trim Debug] Calculated trims:",{topTrim:l,bottomTrim:u,ratio:s/a}),l===0&&u===0){e.errors.push(`${n.name}: Could not calculate trim values`);continue}try{await figma.loadFontAsync({family:i.family,style:i.style})}catch(y){e.errors.push(`${n.name}: Failed to load font "${i.family} ${i.style}"`);continue}n.textAutoResize==="NONE"&&(n.textAutoResize="HEIGHT");let m=figma.createFrame();m.name=`${n.name} (Trimmed)`,m.layoutMode="VERTICAL",m.primaryAxisSizingMode="AUTO",m.counterAxisSizingMode="AUTO",m.paddingTop=0,m.paddingBottom=0,m.paddingLeft=0,m.paddingRight=0,m.fills=[],m.clipsContent=!1,m.x=n.x-l,m.y=n.y-l;let g=n.parent,p=0;g&&"children"in g&&(p=g.children.indexOf(n)),g&&"appendChild"in g&&m.appendChild(n),n.x=0,n.y=-l;let h=s-l-u;m.resize(n.width,h),g&&"insertChild"in g&&g.insertChild(p,m),e.trimmedTexts.push({nodeId:n.id,nodeName:n.name,font:{family:i.family,style:i.style},fontSize:a,lineHeight:s,topTrim:l,bottomTrim:u}),e.trimmedNodes++}catch(i){e.errors.push(`${n.name}: ${i}`)}e.success=e.trimmedNodes>0,e.success?figma.notify(`Successfully trimmed ${e.trimmedNodes} text layer${e.trimmedNodes!==1?"s":""}`):figma.notify("Failed to trim text layers",{error:!0}),d("TRIM_COMPLETE",e)}});function G(t,e,o){let r,n=!1;t>32?(r=1.15,n=!0):t>=20?(r=1.25,n=!0):t>=14?r=1.5:r=1.35;let i=e||"";(i.includes("Condensed")||i.includes("Compressed")||i.includes("Narrow")||i.includes("Oswald")||i.includes("Bebas"))&&(r-=.1),n||(o==="Serif"||i.includes("Merriweather")||i.includes("Lora")||i.includes("Playfair"))&&(r+=.1),(i.includes("Display")||o==="Handwriting")&&(r-=.05);let a=t*r,s=b(e),c;if(s){let{ascent:u,descent:m,unitsPerEm:g}=s,p=(Math.abs(u)+Math.abs(m))/g,h=t*p,y=t*.1,F=h+y;if(n){let x=Math.max(a,F),N=x%1;N>0&&N<=.2?c=Math.floor(x):c=Math.ceil(x)}else{let x=Math.max(a,F);c=Math.ceil(x/4)*4}}else n?c=Math.ceil(a):c=Math.ceil(a/4)*4;let l=Math.max(t+4,t*1.05);return c<l&&(c=Math.ceil(l)),c}function U(t,e=""){return G(t,e)}function De(t,e,o=""){let r=U(t,o),n=Math.abs(r-e);return Math.round(n)}var k=f(()=>{"use strict";B()});function j(t,e,o=""){let r=G(t,o),n=e/t,i=e-r;return Math.abs(i)<=.5?{hasIssue:!1,issueType:"OPTIMAL",ratio:n,recommended:r}:i<0?{hasIssue:!0,issueType:"TOO_TIGHT",ratio:n,recommended:r}:{hasIssue:!0,issueType:"TOO_LOOSE",ratio:n,recommended:r}}var Xe=f(()=>{"use strict";k()});var Ve,qe=f(()=>{"use strict";S();W();Xe();k();Ve=async function(){let t=figma.currentPage.selection,e={totalScanned:0,issuesFound:0,textLayers:[]};if(t.length===0){figma.notify("Please select at least one text layer",{error:!0}),d("LINE_HEIGHT_SCAN_COMPLETE",e);return}function o(n){let i=[];for(let a of n)a.type==="TEXT"?i.push(a):"children"in a&&i.push(...o(a.children));return i}let r=o(t);if(r.length===0){figma.notify("No text layers found in selection",{error:!0}),d("LINE_HEIGHT_SCAN_COMPLETE",e);return}for(let n of r)try{let i=n.fontName;if(i===figma.mixed){console.log(`[LH Scan] Skipping ${n.name}: mixed fonts`);continue}let a=n.fontSize;if(a===figma.mixed){console.log(`[LH Scan] Skipping ${n.name}: mixed font sizes`);continue}if(n.lineHeight===figma.mixed){console.log(`[LH Scan] WARNING: ${n.name} has mixed line heights!`),console.log("[LH Scan] Checking all characters to find worst case...");let g=n.characters,p=1.5,h=a*1.5,y=!1,F="OPTIMAL";for(let x=0;x<g.length;x++){let N=n.getRangeLineHeight(x,x+1);if(N!==figma.mixed&&N.unit==="PIXELS"){let M=j(a,N.value,i.family);M.hasIssue&&(y||(y=!0,h=N.value,p=M.ratio,F=M.issueType))}}if(y){console.log(`[LH Scan] Worst case in ${n.name}:`,{lineHeight:h,ratio:p.toFixed(2),issueType:F});let x=U(a,i.family);e.textLayers.push({nodeId:n.id,nodeName:`${n.name} (mixed)`,fontFamily:i.family,fontStyle:i.style,fontSize:a,lineHeight:h,lineHeightRatio:p,hasIssue:!0,issueType:F,recommendedLineHeight:x,overlapAmount:Math.abs(x-h)}),e.totalScanned++,e.issuesFound++}else console.log(`[LH Scan] ${n.name} has mixed line heights but all are optimal`);continue}let c=O(n),l=j(a,c,i.family),u=l.recommended,m=De(a,c,i.family);console.log(`[LH Scan] ${n.name}:`,{fontSize:a,lineHeight:c,ratio:l.ratio.toFixed(2),issueType:l.issueType,hasIssue:l.hasIssue,recommended:u}),e.textLayers.push({nodeId:n.id,nodeName:n.name,fontFamily:i.family,fontStyle:i.style,fontSize:a,lineHeight:c,lineHeightRatio:l.ratio,hasIssue:l.hasIssue,issueType:l.issueType,recommendedLineHeight:l.hasIssue?u:void 0,overlapAmount:l.hasIssue?m:void 0}),e.totalScanned++,l.hasIssue&&e.issuesFound++}catch(i){console.error(`[LH Scan] Error scanning ${n.name}:`,i)}e.issuesFound>0?figma.notify(`Found ${e.issuesFound} line height issue${e.issuesFound===1?"":"s"}`):figma.notify("All line heights are optimal!"),d("LINE_HEIGHT_SCAN_COMPLETE",e)}});var Ze,Ke=f(()=>{"use strict";S();Ze=async function(t){try{let e=figma.getNodeById(t.nodeId);if(!e||e.type!=="TEXT"){figma.notify("Text layer not found",{error:!0});return}let o=e.fontName;if(o===figma.mixed){figma.notify("Cannot fix text with mixed fonts",{error:!0});return}await figma.loadFontAsync({family:o.family,style:o.style}),e.lineHeight={value:t.newLineHeight,unit:"PIXELS"},figma.notify(`\u2713 Updated "${e.name}" line height to ${t.newLineHeight}px`),d("SCAN_LINE_HEIGHTS")}catch(e){figma.notify(`Failed to fix line height: ${e}`,{error:!0})}}});var D={};nt(D,{default:()=>ft});function ft(){H("SCAN_FONTS",re),H("APPLY_REPLACEMENT",ae),H("BULK_UPDATE",ce),H("PREVIEW_SELECTION",ue),H("REQUEST_AVAILABLE_FONTS",fe),H("TRIM_TEXT",ke),H("SCAN_LINE_HEIGHTS",Ve),H("FIX_LINE_HEIGHT",Ze),H("SELECT_NODE",ge),$("close",function(){figma.closePlugin()}),P({width:380,height:480})}var X=f(()=>{"use strict";S();ie();se();le();me();de();pe();je();qe();Ke()});var mt={"src/main.ts--default":(X(),K(D)).default,open:(X(),K(D)).default},ut=typeof figma.command=="undefined"||figma.command===""||figma.command==="generate"?"src/main.ts--default":figma.command;mt[ut]();
